# AgentSocial ğŸ¤–

> **ä¸º AI Agent æä¾›ç¤¾äº¤èº«ä»½** â€”â€” ä¸€ä¸ªå°†æœ¬åœ° AI CLIï¼ˆå¦‚ Gemini CLI, Claude Codeï¼‰ä¸ç¤¾äº¤å¹³å°ï¼ˆé£ä¹¦ç­‰ï¼‰æ— ç¼è¿æ¥çš„æ™ºèƒ½ç½‘æ¡¥ã€‚

[![License](https://img.shields.io/badge/license-ISC-blue.svg)](LICENSE)
[![Node.js](https://img.shields.io/badge/node-%3E%3D18.0.0-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue.svg)](https://www.typescriptlang.org/)

AgentSocial æ˜¯ä¸€ä¸ªè½»é‡çº§ä½†åŠŸèƒ½å¼ºå¤§çš„ä¸­é—´ä»¶ï¼Œæ—¨åœ¨è®©ä½ é€šè¿‡ç†Ÿæ‚‰çš„ç¤¾äº¤è½¯ä»¶ï¼ˆå¦‚é£ä¹¦ã€é’‰é’‰ï¼‰è¿œç¨‹ã€å®‰å…¨åœ°ç®¡ç†æœ¬åœ°é¡¹ç›®ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„è½¬å‘å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªå¸¦æœ‰â€œå®‰å…¨å®¡æ ¸æœºåˆ¶â€çš„ Agent æ‰˜ç®¡ç¯å¢ƒã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ›¡ï¸ å®‰å…¨å¯æ§ï¼šåŒé˜¶æ®µæ‰§è¡Œæ¨¡å¼**
  - **è®¡åˆ’é˜¶æ®µ (Plan)**: Agent æ¥æ”¶æŒ‡ä»¤åï¼Œå…ˆç”Ÿæˆè¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’ï¼ˆè¦æ”¹å“ªäº›æ–‡ä»¶ã€æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ï¼‰ã€‚
  - **ç¡®è®¤é˜¶æ®µ (Auto)**: è®¡åˆ’ä»¥äº¤äº’å¼å¡ç‰‡å‘é€è‡³æ‰‹æœºï¼Œåªæœ‰åœ¨ä½ ç‚¹å‡»â€œç¡®è®¤â€åï¼ŒAgent æ‰ä¼šæ­£å¼åŠ¨æ‰‹ã€‚
- **ğŸ”Œ é›¶æˆæœ¬å†…ç½‘ç©¿é€**
  - åŸºäºé£ä¹¦ WebSocket æ¨¡å¼ï¼Œ**æ— éœ€å…¬ç½‘ IPï¼Œæ— éœ€é…ç½® Webhook åœ°å€**ï¼Œåªè¦ä½ çš„ç”µè„‘èƒ½ä¸Šç½‘ï¼Œå°±èƒ½åœ¨å…¨ä¸–ç•Œä»»ä½•åœ°æ–¹æŒ‡æŒ¥å®ƒã€‚
- **ğŸ§  æ·±åº¦éš”ç¦»ä¸æƒé™ï¼šå¤šä¼šè¯ä¸å®‰å…¨è®¤è¯ç®¡ç†**
  - ä¸ºæ¯ä¸ªä¼šè¯è‡ªåŠ¨åˆ›å»º**ç¡¬éš”ç¦»**çš„è¿è¡Œç¯å¢ƒã€‚
  - **å‡­è¯åŒæ­¥**: é€šè¿‡ç¬¦å·é“¾æ¥ï¼ˆSymlinkï¼‰å®‰å…¨å…±äº«å…¨å±€ Google è®¤è¯ï¼Œé¿å…å‡­è¯æ‰©æ•£ã€‚
  - **è®¿é—®æ§åˆ¶**: è‡ªåŠ¨åŒæ­¥é£ä¹¦â€œåº”ç”¨å¯è§èŒƒå›´â€ï¼Œé‡‡ç”¨ **Fail-Closed** å®‰å…¨ç­–ç•¥ï¼Œåªæœ‰æˆæƒæˆå‘˜æ‰èƒ½æ§åˆ¶ã€‚
- **ğŸ“¢ çŠ¶æ€æ„ŸçŸ¥ï¼šæ™ºèƒ½å¹¿æ’­é€šçŸ¥**
  - æœºå™¨äººä¸Šçº¿/ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å‘ç¾¤ç»„åŠâ€œå¯è§èŒƒå›´â€å†…çš„æˆå‘˜æ¨é€ç§èŠé€šçŸ¥ï¼Œç¡®ä¿ç›¸å…³æˆå‘˜ç¬¬ä¸€æ—¶é—´è·çŸ¥ Agent çŠ¶æ€ã€‚
- **âš¡ æ™ºèƒ½é¢„çƒ­ (Pre-warming)**
  - å¯åŠ¨æ—¶è‡ªåŠ¨å»ºç«‹é¡¹ç›®ç´¢å¼•ï¼Œç¡®ä¿ Agent åœ¨å“åº”æŒ‡ä»¤å‰å·²å¿«é€Ÿå°±ç»ªã€‚
- **ğŸ¤– å¤š Agent å¼•æ“æ”¯æŒ**
  - æ·±åº¦é›†æˆ `Gemini CLI`ï¼Œå¹¶æä¾› `Claude Code` ä¸ `Codex` çš„æ‰©å±•æŒ‡å¼•ã€‚
- **ğŸ è·¨å¹³å°å…¼å®¹**
  - å®Œç¾æ”¯æŒ **macOS** ä¸ **Windows**ï¼Œè‡ªåŠ¨å¤„ç†å¹³å°å·®å¼‚ï¼ˆå¦‚ Windows .cmd æ–‡ä»¶åŒ…è£…ï¼‰ã€‚

---

## ğŸ”„ å·¥ä½œæµç¨‹ (How it Works)

1. **æ¥æ”¶æŒ‡ä»¤**ï¼šç”¨æˆ·åœ¨é£ä¹¦ç¾¤æˆ–ç§èŠä¸­å‘é€æŒ‡ä»¤ï¼ˆå¦‚ï¼š`@æœºå™¨äºº å¸®æˆ‘å†™ä¸ªç”¨æˆ·ç™»å½•æ¥å£`ï¼‰ã€‚
2. **è®¡åˆ’ç”Ÿæˆ**ï¼šAgent è¿›å…¥ `Plan` æ¨¡å¼ï¼Œåˆ†æä»£ç åº“å¹¶è¾“å‡ºé¢„æœŸçš„ä¿®æ”¹æ–¹æ¡ˆã€‚
3. **å¡ç‰‡æ¨é€**ï¼šAgentSocial å°†è®¡åˆ’å°è£…ä¸ºé£ä¹¦**å¯æŠ˜å è¯¦æƒ…å¡ç‰‡**æ¨é€åˆ°ç”¨æˆ·æ‰‹æœºï¼Œé•¿å†…å®¹è‡ªåŠ¨æ”¶èµ·ï¼Œç•Œé¢æ›´æ¸…çˆ½ã€‚
4. **äººå·¥ç¡®è®¤**ï¼šç”¨æˆ·é¢„è§ˆè®¡åˆ’ï¼Œç‚¹å‡»â€œğŸš€ ç¡®è®¤è®¡åˆ’å¹¶å¼€å·¥â€ã€‚
5. **è‡ªåŠ¨æ‰§è¡Œ**ï¼šAgent è¿›å…¥ `Auto` æ¨¡å¼ï¼Œåœ¨éš”ç¦»ç¯å¢ƒä¸­è‡ªåŠ¨æ‰§è¡Œæ“ä½œã€‚
6. **ç»“æœå›ä¼ **ï¼šæ‰§è¡ŒæˆåŠŸåï¼Œå›ä¼ è¯¦ç»†çš„ç»“æœå¡ç‰‡ï¼ˆåŒ…å«ä¿®æ”¹çš„æ–‡ä»¶æˆ–è¿è¡Œç»“æœï¼‰ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç³»ç»Ÿè¦æ±‚
- [Node.js](https://nodejs.org/) v18.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
- å·²å®‰è£…å¹¶ç™»å½• [Gemini CLI](https://github.com/google/gemini-cli) (æˆ–ä½ é€‰æ‹©çš„å…¶ä»– Agent CLI)ã€‚
- èƒ½å¤Ÿè®¿é—®é£ä¹¦å¼€æ”¾å¹³å°ã€‚

### 2. å®‰è£…

é€šè¿‡ [GitHub CLI](https://cli.github.com/) éªŒè¯å¹¶å®‰è£…ï¼š

```bash
# 1. ç™»å½• GitHub
gh auth login

# 2. åˆ·æ–°æƒé™ä»¥æ”¯æŒè¯»å– Packages
gh auth refresh -s read:packages

# 3. é…ç½® npm auth token
npm config set //npm.pkg.github.com/:_authToken=$(gh auth token)

# 4. å…¨å±€å®‰è£…
npm install -g @zhangyu528/agentsocial --@zhangyu528:registry=https://npm.pkg.github.com
```

### 3. é…ç½®å‘å¯¼ (Setup)
åœ¨ä»»æ„ç»ˆç«¯æ‰§è¡Œï¼š
```bash
agentsocial setup
```
ç¨‹åºå°†å¼•å¯¼ä½ ï¼š
1. **æ™ºèƒ½æ£€æµ‹**: è‡ªåŠ¨æ¢æµ‹æœ¬åœ°æ˜¯å¦å®‰è£…äº† Gemini CLI ç­‰ Agent ç¯å¢ƒï¼Œå¹¶ç»™å‡ºè¯¦ç»†å®‰è£…å»ºè®®ã€‚
2. **è¾“å…¥**: å½•å…¥é£ä¹¦ App ID / Secretã€‚
3. **ä¸€é”®è¯Šæ–­**: è‡ªåŠ¨éªŒè¯é£ä¹¦æƒé™é…ç½®ã€Scopes å’Œäº‹ä»¶è®¢é˜…ã€‚
4. **å…¨çƒåŒ–å­˜å‚¨**: é…ç½®æ–‡ä»¶ä¸ä¼šè¯æ•°æ®å®‰å…¨åœ°å­˜å‚¨åœ¨ç”¨æˆ·ä¸»ç›®å½• `~/.agentsocial/` ä¸­ã€‚

### 4. è¿è¡Œ
```bash
agentsocial run
```

è¿è¡Œåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼€å§‹ï¼š
- **ç›´æ¥ç§èŠ**: æ‚¨å¯ä»¥ç›´æ¥åœ¨é£ä¹¦ç§èŠæ¡†è¾“å…¥æŒ‡ä»¤ï¼Œæ— éœ€ @ æœºå™¨äººã€‚
- **æ‹‰æˆ‘å…¥ç¾¤**: å°†æœºå™¨äººæ‹‰å…¥æ‚¨çš„é¡¹ç›®ç¾¤ï¼Œå¹¶é€šè¿‡ @æˆ‘ çš„æ–¹å¼ä¸‹è¾¾æŒ‡ä»¤ã€‚
- **ä»»åŠ¡å®¡æ‰¹**: æœºå™¨äººä¼šå…ˆå›ä¼ æ‰§è¡Œè®¡åˆ’ï¼Œå¾…æ‚¨ç‚¹å‡»â€œæ‰¹å‡†â€æŒ‰é’®åå®ƒå°†æ­£å¼åŠ¨å·¥ã€‚

---

## ğŸ› ï¸ æŒ‡ä»¤è¡¨

| æŒ‡ä»¤ | åˆ«å | è¯´æ˜ |
| :--- | :--- | :--- |
| `agentsocial setup` | - | **äº¤äº’å¼é…ç½®**ã€‚å¼•å¯¼å®Œæˆé£ä¹¦åº”ç”¨å¯¹æ¥ä¸æƒé™æ ¡éªŒã€‚ |
| `agentsocial run` | (é»˜è®¤) | **å¯åŠ¨æœåŠ¡**ã€‚æ ¹æ® `config.json` å¯åŠ¨æ‰€æœ‰æœºå™¨äººå®ä¾‹ã€‚ |
| `agentsocial -h` | `--help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚ |

---

## âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥ (Troubleshooting)

### 1. æœºå™¨äººæ— æ³•æ¥æ”¶æ¶ˆæ¯ / å‘é€å¡ç‰‡å¤±è´¥
è¯·æ£€æŸ¥é£ä¹¦å¼€å‘è€…åå°ï¼š
- **å¯ç”¨æœºå™¨äºº**: `åº”ç”¨åŠŸèƒ½` -> `æœºå™¨äºº` -> `å¯ç”¨` (è¿™æ˜¯æœ€å¸¸è¢«é—æ¼çš„ä¸€æ­¥)ã€‚
- **å‘å¸ƒåº”ç”¨**: ä»»ä½•æƒé™æˆ–äº‹ä»¶è®¢é˜…çš„ä¿®æ”¹ï¼Œå¿…é¡» **åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ** æ‰ä¼šç”Ÿæ•ˆã€‚

### 2. å¡ç‰‡æ˜¾ç¤º "Trigger Failed" æˆ–è¿”å›é”™è¯¯ç 
- è¿™æ˜¯ç”±äºç½‘ç»œå»¶è¿Ÿå¯¼è‡´åŒæ­¥å“åº”è¶…æ—¶ã€‚
- **è§£å†³æ–¹æ¡ˆ**: æˆ‘ä»¬å·²ä¼˜åŒ–ä¸ºâ€œæé€Ÿå“åº” + å¼‚æ­¥æ›´æ–°â€æ¨¡å¼ï¼Œè¯·ç¡®ä¿æ›´æ–°åˆ°æœ€æ–°ä»£ç å¹¶é‡æ–°è¿è¡Œã€‚

### 3. Agent æç¤º "429 Too Many Requests"
- è¿™æ˜¯ Gemini API çš„é€Ÿç‡é™åˆ¶ã€‚
- **å»ºè®®**: é¿å…åœ¨ `Auto` æ¨¡å¼ä¸‹ä¸€æ¬¡æ€§ä¸‹è¾¾è¿‡äºå¤æ‚çš„å…¨é¡¹ç›®é‡æ„æŒ‡ä»¤ã€‚

---

### é…ç½®æ–‡ä»¶å­˜å‚¨ (`settings.json`)
AgentSocial çš„é…ç½®ç°åœ¨å­˜å‚¨åœ¨å…¨å±€ç›®å½• `~/.agentsocial/settings.json` ä¸­ï¼Œç¡®ä¿å¯†é’¥ä¸éšé¡¹ç›®æºç æ³„éœ²ï¼š
```json
[
  {
    "platform": "feishu",
    "app_id": "cli_xxxx",
    "app_secret": "xxxx",
    "agent_type": "gemini cli",
    "project_path": "D:/projects/my-web-app"
  }
]
```

---

## âš ï¸ é£ä¹¦æƒé™å¤æ ¸æ¸…å•

è‹¥æœºå™¨äººæ— æ³•æ¥æ”¶æ¶ˆæ¯æˆ–å‘é€å¡ç‰‡ï¼Œè¯·æ£€æŸ¥é£ä¹¦å¼€å‘è€…åå°ï¼š

1.  **å¯ç”¨æœºå™¨äºº**: åº”ç”¨åŠŸèƒ½ -> æœºå™¨äºº -> å¯ç”¨
2.  **æ ¸å¿ƒæƒé™ (Scopes)**:
    - `im:message:readonly` (è·å–å•èŠã€ç¾¤ç»„æ¶ˆæ¯)
    - `im:message.p2p_msg:readonly` (è¯»å–ç”¨æˆ·å‘ç»™æœºå™¨äººçš„å•èŠæ¶ˆæ¯)
    - `im:message.group_at_msg:readonly` (æ¥æ”¶ç¾¤èŠä¸­@æœºå™¨äººæ¶ˆæ¯äº‹ä»¶)
    - `im:message:send_as_bot` (ä»¥åº”ç”¨çš„èº«ä»½å‘é€æ¶ˆæ¯)
    - `im:chat:readonly` (è·å–ç¾¤ç»„ä¿¡æ¯)
    - `admin:app.info:readonly` (è·å–åº”ç”¨ä¿¡æ¯)
3.  **äº‹ä»¶è®¢é˜…**:
    - æ·»åŠ  `æ¥æ”¶æ¶ˆæ¯ (im.message.receive_v1)`ã€‚
4.  **å¡ç‰‡å›è°ƒ**:
    - å¼€å¯ `æ¶ˆæ¯å¡ç‰‡æ“ä½œ (card.action.trigger)`ã€‚
5.  **å‘å¸ƒ**:
    - è®°å¾— **åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ**ï¼Œæ‰€æœ‰ä¿®æ”¹æ‰ä¼šç”Ÿæ•ˆã€‚

---

## ğŸ“œ å¼€å‘è€…ä¸è´¡çŒ®

### å¼€å‘æ¨¡å¼
```bash
# å¯åŠ¨çƒ­æ›´æ–°å¼€å‘ç¯å¢ƒ
npm run dev

# ç›´æ¥è¿è¡Œ setup æŒ‡ä»¤çš„å¼€å‘ç‰ˆ
npm run dev:setup

# ç›´æ¥è¿è¡Œå¯åŠ¨æŒ‡ä»¤çš„å¼€å‘ç‰ˆ
npm run dev:run
```

### æ¶æ„è®¾è®¡
æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯·å‚è€ƒ [ARCHITECTURE.md](./ARCHITECTURE.md)ã€‚

---

## ğŸ“„ å¼€æºåè®®
æœ¬é¡¹ç›®éµå¾ª [ISC License](./LICENSE)ã€‚
