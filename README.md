# AgentSocial ğŸ¤–

> **ä¸º AI Agent æä¾›ç¤¾äº¤èº«ä»½** â€”â€” ä¸€ä¸ªå°†æœ¬åœ° AI CLIï¼ˆå¦‚ Gemini CLI, Claude Codeï¼‰ä¸ç¤¾äº¤å¹³å°ï¼ˆé£ä¹¦ç­‰ï¼‰æ— ç¼è¿æ¥çš„æ™ºèƒ½ç½‘æ¡¥ã€‚

[![License](https://img.shields.io/badge/license-ISC-blue.svg)](LICENSE)
[![Node.js](https://img.shields.io/badge/node-%3E%3D18.0.0-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue.svg)](https://www.typescriptlang.org/)

AgentSocial æ˜¯ä¸€ä¸ªè½»é‡çº§ä½†åŠŸèƒ½å¼ºå¤§çš„ä¸­é—´ä»¶ï¼Œæ—¨åœ¨è®©ä½ é€šè¿‡ç†Ÿæ‚‰çš„ç¤¾äº¤è½¯ä»¶ï¼ˆå¦‚é£ä¹¦ã€é’‰é’‰ï¼‰è¿œç¨‹ã€å®‰å…¨åœ°ç®¡ç†æœ¬åœ°é¡¹ç›®ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„è½¬å‘å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªå¸¦æœ‰â€œå®‰å…¨å®¡æ ¸æœºåˆ¶â€çš„ Agent æ‰˜ç®¡ç¯å¢ƒã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ›¡ï¸ å®‰å…¨å¯æ§ï¼šåŒé˜¶æ®µæ‰§è¡Œæ¨¡å¼**
  - **è®¡åˆ’é˜¶æ®µ (Plan)**: Agent æ¥æ”¶æŒ‡ä»¤åï¼Œå…ˆç”Ÿæˆè¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’ï¼ˆè¦æ”¹å“ªäº›æ–‡ä»¶ã€æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ï¼‰ã€‚
  - **ç¡®è®¤é˜¶æ®µ (Auto)**: è®¡åˆ’ä»¥äº¤äº’å¼å¡ç‰‡å‘é€è‡³æ‰‹æœºï¼Œåªæœ‰åœ¨ä½ ç‚¹å‡»â€œç¡®è®¤â€åï¼ŒAgent æ‰ä¼šæ­£å¼åŠ¨æ‰‹ã€‚
- **ğŸ”Œ é›¶æˆæœ¬å†…ç½‘ç©¿é€**
  - åŸºäºé£ä¹¦ WebSocket æ¨¡å¼ï¼Œ**æ— éœ€å…¬ç½‘ IPï¼Œæ— éœ€é…ç½® Webhook åœ°å€**ï¼Œåªè¦ä½ çš„ç”µè„‘èƒ½ä¸Šç½‘ï¼Œå°±èƒ½åœ¨å…¨ä¸–ç•Œä»»ä½•åœ°æ–¹æŒ‡æŒ¥å®ƒã€‚
- **ğŸ§  æ·±åº¦éš”ç¦»ä¸æƒé™ï¼šå¤šä¼šè¯ä¸å¯è§èŒƒå›´ç®¡ç†**
  - ä¸ºæ¯ä¸ªç¾¤èŠã€æ¯ä¸ªç”¨æˆ·è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹çš„ `.gemini` è¿è¡Œç¯å¢ƒã€‚
  - **è®¿é—®æ§åˆ¶**: è‡ªåŠ¨åŒæ­¥é£ä¹¦â€œåº”ç”¨å¯è§èŒƒå›´â€ï¼Œåªæœ‰æˆæƒæˆå‘˜æ‰èƒ½æ§åˆ¶ Agentï¼Œé˜²æ­¢éç›¸å…³äººå‘˜è¯¯æ“ä½œã€‚
- **ğŸ“¢ çŠ¶æ€æ„ŸçŸ¥ï¼šæ™ºèƒ½å¹¿æ’­é€šçŸ¥**
  - æœºå™¨äººä¸Šçº¿/ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å‘ç¾¤ç»„åŠâ€œå¯è§èŒƒå›´â€å†…çš„æˆå‘˜æ¨é€ç§èŠé€šçŸ¥ï¼Œç¡®ä¿ç›¸å…³æˆå‘˜ç¬¬ä¸€æ—¶é—´è·çŸ¥ Agent çŠ¶æ€ã€‚
- **ğŸ“± å¤šç«¯å®æ—¶åŒæ­¥**
  - PC ç«¯ç‚¹å‡»æ“ä½œï¼Œæ‰‹æœºç«¯æ¯«ç§’çº§åŒæ­¥çŠ¶æ€ã€‚æ‰€æœ‰å¡ç‰‡æ“ä½œå‡æ”¯æŒå¤šè®¾å¤‡ä¸€è‡´æ€§æ›´æ–°ã€‚
- **âš¡ æ™ºèƒ½é¢„çƒ­ (Pre-warming)**
  - å¯åŠ¨æ—¶è‡ªåŠ¨å»ºç«‹é¡¹ç›®ç´¢å¼•ï¼Œç¡®ä¿ Agent åœ¨å“åº”ä½ çš„ç¬¬ä¸€æ¡æŒ‡ä»¤å‰å·²ç»â€œè¯»è¿‡â€é¡¹ç›®ä»£ç ï¼Œå‘Šåˆ«å†·å¯åŠ¨ç­‰å¾…ã€‚
- **ğŸ–¥ï¸ å®æ—¶ç›‘æ§ä»ªè¡¨ç›˜**
  - é›†æˆæ§åˆ¶å° UIï¼Œå®æ—¶å±•ç¤ºå„ä¸ª Bot å®ä¾‹çš„åœ¨çº¿çŠ¶æ€ã€ä»»åŠ¡æ‰§è¡Œè¿›åº¦åŠé”™è¯¯æ—¥å¿—ã€‚
- **ğŸ¤– å¤š Agent å¼•æ“æ”¯æŒ**
  - åŸç”Ÿæ”¯æŒ `Gemini CLI`ï¼Œå¹¶é¢„ç•™äº† `Claude Code` ä¸ `Codex` çš„æ‰©å±•æ¥å£ã€‚

---

## ğŸ”„ å·¥ä½œæµç¨‹ (How it Works)

1. **æ¥æ”¶æŒ‡ä»¤**ï¼šç”¨æˆ·åœ¨é£ä¹¦ç¾¤æˆ–ç§èŠä¸­å‘é€æŒ‡ä»¤ï¼ˆå¦‚ï¼š`@æœºå™¨äºº å¸®æˆ‘å†™ä¸ªç”¨æˆ·ç™»å½•æ¥å£`ï¼‰ã€‚
2. **è®¡åˆ’ç”Ÿæˆ**ï¼šAgent è¿›å…¥ `Plan` æ¨¡å¼ï¼Œåˆ†æä»£ç åº“å¹¶è¾“å‡ºé¢„æœŸçš„ä¿®æ”¹æ–¹æ¡ˆã€‚
3. **å¡ç‰‡æ¨é€**ï¼šAgentSocial å°†è®¡åˆ’å°è£…ä¸ºé£ä¹¦**å¯æŠ˜å è¯¦æƒ…å¡ç‰‡**æ¨é€åˆ°ç”¨æˆ·æ‰‹æœºï¼Œé•¿å†…å®¹è‡ªåŠ¨æ”¶èµ·ï¼Œç•Œé¢æ›´æ¸…çˆ½ã€‚
4. **äººå·¥ç¡®è®¤**ï¼šç”¨æˆ·é¢„è§ˆè®¡åˆ’ï¼Œç‚¹å‡»â€œğŸš€ ç¡®è®¤è®¡åˆ’å¹¶å¼€å·¥â€ã€‚
5. **è‡ªåŠ¨æ‰§è¡Œ**ï¼šAgent è¿›å…¥ `Auto` æ¨¡å¼ï¼Œåœ¨éš”ç¦»ç¯å¢ƒä¸­è‡ªåŠ¨æ‰§è¡Œæ“ä½œã€‚
6. **ç»“æœå›ä¼ **ï¼šæ‰§è¡ŒæˆåŠŸåï¼Œå›ä¼ è¯¦ç»†çš„ç»“æœå¡ç‰‡ï¼ˆåŒ…å«ä¿®æ”¹çš„æ–‡ä»¶æˆ–è¿è¡Œç»“æœï¼‰ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç³»ç»Ÿè¦æ±‚
- [Node.js](https://nodejs.org/) v18.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
- å·²å®‰è£…å¹¶ç™»å½• [Gemini CLI](https://github.com/google/gemini-cli) (æˆ–ä½ é€‰æ‹©çš„å…¶ä»– Agent CLI)ã€‚
- èƒ½å¤Ÿè®¿é—®é£ä¹¦å¼€æ”¾å¹³å°ã€‚

### 2. å®‰è£…ä¸æ„å»º

**é€šè¿‡ NPM å®‰è£… (æ¨è)**
```bash
npm install -g @zhangyu528/agentsocial
```

**æˆ–è€…é€šè¿‡æºç å®‰è£…**
```bash
# å…‹éš†å¹¶è¿›å…¥é¡¹ç›®ç›®å½•
git clone https://github.com/zhangyu528/AgentSocial.git
cd AgentSocial

# å®‰è£…ä¾èµ–
npm install

# ç¼–è¯‘ä»£ç 
npm run build

# (æ¨è) å»ºç«‹å…¨å±€å‘½ä»¤é“¾æ¥ï¼Œä»¥ä¾¿ç›´æ¥ä½¿ç”¨ agentsocial å‘½ä»¤
npm link
```

### 3. é…ç½®å‘å¯¼ (Setup)
åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œï¼š
```bash
agentsocial setup
```
ç¨‹åºå°†å¼•å¯¼ä½ ï¼š
1. **è‡ªåŠ¨æ£€æµ‹** æœ¬åœ° Agent ç¯å¢ƒã€‚
2. **è¾“å…¥** é£ä¹¦ App ID / Secretã€‚
3. **ä¸€é”®è¯Šæ–­** é£ä¹¦åå°æƒé™é…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆè‡ªåŠ¨æ£€æµ‹ Scopes å’Œäº‹ä»¶è®¢é˜…ï¼‰ã€‚

### 4. è¿è¡Œ
```bash
agentsocial run
```

è¿è¡Œåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼€å§‹ï¼š
- **ç›´æ¥ç§èŠ**: æ‚¨å¯ä»¥ç›´æ¥åœ¨é£ä¹¦ç§èŠæ¡†è¾“å…¥æŒ‡ä»¤ï¼Œæ— éœ€ @ æœºå™¨äººã€‚
- **æ‹‰æˆ‘å…¥ç¾¤**: å°†æœºå™¨äººæ‹‰å…¥æ‚¨çš„é¡¹ç›®ç¾¤ï¼Œå¹¶é€šè¿‡ @æˆ‘ çš„æ–¹å¼ä¸‹è¾¾æŒ‡ä»¤ã€‚
- **ä»»åŠ¡å®¡æ‰¹**: æœºå™¨äººä¼šå…ˆå›ä¼ æ‰§è¡Œè®¡åˆ’ï¼Œå¾…æ‚¨ç‚¹å‡»â€œæ‰¹å‡†â€æŒ‰é’®åå®ƒå°†æ­£å¼åŠ¨å·¥ã€‚

---

## ğŸ› ï¸ æŒ‡ä»¤è¡¨

| æŒ‡ä»¤ | åˆ«å | è¯´æ˜ |
| :--- | :--- | :--- |
| `agentsocial setup` | - | **äº¤äº’å¼é…ç½®**ã€‚å¼•å¯¼å®Œæˆé£ä¹¦åº”ç”¨å¯¹æ¥ä¸æƒé™æ ¡éªŒã€‚ |
| `agentsocial run` | (é»˜è®¤) | **å¯åŠ¨æœåŠ¡**ã€‚æ ¹æ® `config.json` å¯åŠ¨æ‰€æœ‰æœºå™¨äººå®ä¾‹ã€‚ |
| `agentsocial -h` | `--help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚ |

---

## âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥ (Troubleshooting)

### 1. æœºå™¨äººæ— æ³•æ¥æ”¶æ¶ˆæ¯ / å‘é€å¡ç‰‡å¤±è´¥
è¯·æ£€æŸ¥é£ä¹¦å¼€å‘è€…åå°ï¼š
- **å¯ç”¨æœºå™¨äºº**: `åº”ç”¨åŠŸèƒ½` -> `æœºå™¨äºº` -> `å¯ç”¨` (è¿™æ˜¯æœ€å¸¸è¢«é—æ¼çš„ä¸€æ­¥)ã€‚
- **å‘å¸ƒåº”ç”¨**: ä»»ä½•æƒé™æˆ–äº‹ä»¶è®¢é˜…çš„ä¿®æ”¹ï¼Œå¿…é¡» **åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ** æ‰ä¼šç”Ÿæ•ˆã€‚

### 2. å¡ç‰‡æ˜¾ç¤º "Trigger Failed" æˆ–è¿”å›é”™è¯¯ç 
- è¿™æ˜¯ç”±äºç½‘ç»œå»¶è¿Ÿå¯¼è‡´åŒæ­¥å“åº”è¶…æ—¶ã€‚
- **è§£å†³æ–¹æ¡ˆ**: æˆ‘ä»¬å·²ä¼˜åŒ–ä¸ºâ€œæé€Ÿå“åº” + å¼‚æ­¥æ›´æ–°â€æ¨¡å¼ï¼Œè¯·ç¡®ä¿æ›´æ–°åˆ°æœ€æ–°ä»£ç å¹¶é‡æ–°è¿è¡Œã€‚

### 3. Agent æç¤º "429 Too Many Requests"
- è¿™æ˜¯ Gemini API çš„é€Ÿç‡é™åˆ¶ã€‚
- **å»ºè®®**: é¿å…åœ¨ `Auto` æ¨¡å¼ä¸‹ä¸€æ¬¡æ€§ä¸‹è¾¾è¿‡äºå¤æ‚çš„å…¨é¡¹ç›®é‡æ„æŒ‡ä»¤ã€‚

---

## ğŸ“‚ è¿›é˜¶ç®¡ç†

### é…ç½®æ–‡ä»¶ç»“æ„ (`config.json`)
AgentSocial æ”¯æŒåŒæ—¶è¿è¡Œå¤šä¸ª Bot ç®¡ç†ä¸åŒçš„é¡¹ç›®ï¼š
```json
[
  {
    "platform": "feishu",
    "app_id": "cli_xxxx",
    "app_secret": "xxxx",
    "agent_type": "gemini cli",
    "project_path": "D:/projects/my-web-app"
  }
]
```

### è¿è¡Œç¯å¢ƒéš”ç¦»æœºåˆ¶
- **å­˜å‚¨ä½ç½®**: `sessions/{app_id}/{chat_id}/`
- **æœºåˆ¶**: å¯åŠ¨æ—¶è‡ªåŠ¨ä»ç³»ç»Ÿç›®å½•åŒæ­¥èº«ä»½è®¤è¯æ–‡ä»¶ï¼ˆå¦‚ `google_accounts.json`ï¼‰ï¼Œç¡®ä¿ Agent åœ¨éš”ç¦»ç¯å¢ƒä¸‹ä¾ç„¶æ‹¥æœ‰ä½ çš„æˆæƒã€‚

---

## éˆ¿ç‹…ç¬ æ¤‹ç‚°åŠŸé‰å†®æªºæ¾¶å¶†ç‰³å¨“å‘­å´Ÿ

é‘»ãƒ¦æº€é£ã„¤æ±‰éƒçŠ³ç¡¶éºãƒ¦æ•¹å¨‘å Ÿä¼…é´æ §å½‚é–«ä½¸å´±é—å›·ç´ç’‡é”‹î—…éŒãƒ©î—£æ¶”ï¹€ç´‘é™æˆ£â‚¬å‘­æ‚—é™å¸®ç´°

1.  **éšîˆœæ•¤éˆå“„æ«’æµœ**: æ´æ—‚æ•¤é”ç†»å…˜ -> éˆå“„æ«’æµœ -> éšîˆœæ•¤
2.  **éç¨¿ç¸¾é‰å†®æªº (Scopes)**:
    - `im:message:readonly` (è·å–å•èŠã€ç¾¤ç»„æ¶ˆæ¯)
    - `im:message.p2p_msg:readonly` (è¯»å–ç”¨æˆ·å‘ç»™æœºå™¨äººçš„å•èŠæ¶ˆæ¯)
    - `im:message.group_at_msg:readonly` (æ¥æ”¶ç¾¤èŠä¸­@æœºå™¨äººæ¶ˆæ¯äº‹ä»¶)
    - `im:message:send_as_bot` (ä»¥åº”ç”¨çš„èº«ä»½å‘é€æ¶ˆæ¯)
    - `im:chat:readonly` (è·å–ç¾¤ç»„ä¿¡æ¯)
    - `admin:app.info:readonly` (è·å–åº”ç”¨ä¿¡æ¯)
3.  **æµœå¬©æ¬¢ç’ãˆ¤æ§„**:
    - å¨£è¯²å§ `éºãƒ¦æ•¹å¨‘å Ÿä¼… (im.message.receive_v1)`ã€‚
4.  **é—ï¼„å¢–é¥ç‚¶çšŸ**:
    - å¼€å¯ `æ¶ˆæ¯å¡ç‰‡æ“ä½œ (card.action.trigger)`ã€‚
5.  **å‘å¸ƒ**:
    - è®°å¾— **åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ**ï¼Œæ‰€æœ‰ä¿®æ”¹æ‰ä¼šç”Ÿæ•ˆã€‚

---

## ğŸ“œ å¼€å‘è€…ä¸è´¡çŒ®

### å¼€å‘æ¨¡å¼
```bash
# å¯åŠ¨çƒ­æ›´æ–°å¼€å‘ç¯å¢ƒ
npm run dev

# ç›´æ¥è¿è¡Œ setup æŒ‡ä»¤çš„å¼€å‘ç‰ˆ
npm run dev:setup

# ç›´æ¥è¿è¡Œå¯åŠ¨æŒ‡ä»¤çš„å¼€å‘ç‰ˆ
npm run dev:run
```

### æ¶æ„è®¾è®¡
æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯·å‚è€ƒ [ARCHITECTURE.md](./ARCHITECTURE.md)ã€‚

---

## ğŸ“„ å¼€æºåè®®
æœ¬é¡¹ç›®éµå¾ª [ISC License](./LICENSE)ã€‚
